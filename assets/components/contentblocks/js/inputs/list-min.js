!function(a,b){b.fieldTypes.list=function(c,d){var e={itemId:0,rootList:!1};return e.init=function(){a.isArray(d.items)?(e.rootList=c.find("ul"),a.each(d.items,function(a,b){e.addRecursiveItem(e.rootList,b)})):e.addItem(c.find(".contentblocks-field-list-outer"),{value:""}),c.find("ul, ol").sortable({items:"li",connectWith:".contentblocks-field-list-outer ul, .contentblocks-field-list-outer ol",forceHelperSize:!0,forcePlaceholderSizeType:!0,placeholder:"ui-sortable-list-placeholder",tolerance:"pointer",cursor:"move",cancel:"input,textarea,button,select,option",handle:".contentblocks-field-list-move",update:function(a,c){c.item.trigger("contentblocks:field_dragged"),b.fixColumnHeights(),b.fireChange()},start:function(a,b){b.placeholder.height(b.item.height())}})},e.addRecursiveItem=function(b,c){var d=this.addItem(b,{value:c.value});c.items&&c.items.length&&a.each(c.items,function(a,c){e.addRecursiveItem(b.find("#"+d).find("ul").first(),c)})},e.addItem=function(c,f,g,h){e.itemId++,f=f||{value:""},f.id="contentblocks-list-item"+e.itemId,h=h||0===h?h:"last";var i=tmpl("contentblocks-field-list-item",f);"last"===h?c.append(i):c.children("li").eq(h).after(i);var j=c.find("#"+f.id),k=j.find("input");return k.on("keydown",function(b){var c=b.which||b.keyCode,d=a(this),f=d.closest("li"),g=d.val();if(13==c)e.addItem(d.closest("ul"),{},!0,f.index());else if(8==c){if(""==g&&(b.preventDefault(),e.rootList.find("li").length>1)){var h=jQuery.Event("keydown",{which:38});k.trigger(h),d.closest("li").remove()}}else if(9==c){b.preventDefault();var i=null,j=!1;if(b.shiftKey){i=d.closest("ul").closest("li");var l=i.closest(".contentblocks-field-list-outer");i&&l.length>0&&(f.nextAll().appendTo(f.find("ul").first()),f.insertAfter(i),j=!0)}else{var m=f.prev(),n=m.find("ul").first();n.length&&(f.appendTo(n),j=!0)}if(j){var o=f.find("input");o.hasClass("tinyrte-replaced")&&(o.show(),o.siblings(".tinyrte-container").hide()),o.focus()}}else if(38==c){var p=null,q=f.prev();if(q.length){var r=q.find("li").last();p=r.length?r:q}else{var s=f.closest("ul").closest("li"),t=s.closest(".contentblocks-field-list-outer").length;s.length&&t&&(p=s)}p&&p.find("input").first().focus()}else if(40==c){var u=null,v=f.find("li").first(),w=f.next();if(v.length)u=v;else if(w.length)u=w;else{var x=f.closest("ul").closest("li").next(),y=x.closest(".contentblocks-field-list-outer").length;x.length&&y&&(u=x)}u&&u.find("input").first().focus()}}),j.find(".contentblocks-field-list-add").on("click",function(){var c=a(this).closest("li").find(".contentblocks-field-list-nested"),d=c.find("ul > li"),f=a(this);d.length>0?(d.remove(),f.text("»")):(e.addItem(c.find("ul"),{},!0),f.text("«")),b.fireChange()}),j.find(".contentblocks-field-list-delete").on("click",function(){a(this).closest("li").remove(),b.fireChange(),b.fixColumnHeights()}),g&&k.focus(),b.fixColumnHeights(),b.toBoolean(d.properties.use_tinyrte)&&b.addTinyRte(k),f.id},e.getData=function(){var b=c.find(".contentblocks-field-list-outer"),d=[];return b.children("li").each(function(b,c){var f=a(c);d.push({value:f.find("input").first().val(),items:e.getNested(f)})}),{items:d}},e.getNested=function(b){var c=[];return b.find("ul").first().children("li").each(function(b,d){var f=a(d);c.push({value:f.find("input").first().val(),items:e.getNested(f)})}),c},e},b.fieldTypes.ordered_list=function(a,c){return b.fieldTypes.list(a,c)}}(vcJquery,ContentBlocks);
//# sourceMappingURL=list-min.js.map